<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<script type="text/javascript"
src="http://maps.googleapis.com/maps/api/js?libraries=weather,places&sensor=false">
</script>

<script type="text/javascript">
var home = prompt("Enter your Home address");
var dest = window.prompt("Enter your Destination address");
var directionsService = new google.maps.DirectionsService();
function initialize()
{
var location = new google.maps.LatLng(30.613391, -96.338425);
var map_options = {
zoom: 5,
center: location,
mapTypeId: google.maps.MapTypeId.ROADMAP
};
var map = new google.maps.Map(document.getElementById("map_canvas"),map_options)
var directionsDisplay = new google.maps.DirectionsRenderer({'map':map});

var geo = new google.maps.Geocoder;
     geo.geocode({'address':home},function(results, status){
             if (status == google.maps.GeocoderStatus.OK) {
map.setCenter(results[0].geometry.location);
var marker = new google.maps.Marker({
position: results[0].geometry.location,
map: map,
title: 'Current',
draggable: false
});
             } else {
               alert("Geocode was not successful for the following reason: " + status);
             }

      });
var geo = new google.maps.Geocoder;
     geo.geocode({'address':dest},function(results, status){
             if (status == google.maps.GeocoderStatus.OK) {
map.setCenter(results[0].geometry.location);
var marker = new google.maps.Marker({
position: results[0].geometry.location,
map: map,
title: 'Destination',
draggable: false
});
             } else {
               alert("Geocode was not successful for the following reason: " + status);
             }

      });
   var request = {
       origin:home, 
       destination:dest,
       travelMode: google.maps.DirectionsTravelMode.DRIVING
   };
   directionsService.route(request, function(response, status) {
     if (status == google.maps.DirectionsStatus.OK) {
       directionsDisplay.setDirections(response);
     }
   });

var weatherLayer = new google.maps.weather.WeatherLayer({
temperatureUnits: google.maps.weather.TemperatureUnit.FAHRENHEIT
});
weatherLayer.setMap(map);

var cloudLayer = new google.maps.weather.CloudLayer();
cloudLayer.setMap(map);

}  

function calculateDistances() {
 var service = new google.maps.DistanceMatrixService();
 service.getDistanceMatrix(
   {
     origins: [home],
     destinations: [dest],
     travelMode: google.maps.TravelMode.DRIVING,
     unitSystem: google.maps.UnitSystem.IMPERIAL,
     avoidHighways: false,
     avoidTolls: false
   }, callback);
}

function callback(response, status) {
 if (status != google.maps.DistanceMatrixStatus.OK) {
   alert('Error was: ' + status);
 } else {
   var origins = response.originAddresses;
   var destinations = response.destinationAddresses;
   var outputDiv = document.getElementById('outputDiv');
   outputDiv.innerHTML = '';

   for (var i = 0; i < origins.length; i++) {
     var results = response.rows[i].elements;
     for (var j = 0; j < results.length; j++) {
       outputDiv.innerHTML += origins[i] + ' to ' + destinations[j]
           + ': ' + results[j].distance.text + ' in '
           + results[j].duration.text + '<br>';
     }
   }
 }
}
 

google.maps.event.addDomListener(window, 'load', initialize);

</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script>
function GetWeatherForLocation(lat, lon)
{
  $.ajax({
  url:
  "http://api.wundergorund.com/api/44436df8c5396f7d/geolookup/conditions/q/"+lat+","+lon+".json",
  dataType: "jsonp",
  success : function(parsed_json) {
  var location = parsed_json['location']['city'];
  var realTemp_f = parsed_json['current_observation']['temp_f'];
  var realTemp_c = parsed_json['current_observation']['temp_c'];
  var feelsLike_f = parsed_json['current_observation']['feelslike_f'];
  var feelsLike_c = parsed_json['current_observation']['feelslike_c'];
  var wind = parsed_json['current_observation']['wind_mph'];
  var humidity = parsed_json['current_observation']['relative_humidity'];
  var precip = parsed_json['current_observation']['precip_today_string'];
  alert("Temp in " + location + "is: "+realTemp_c + "\nfeels like: "+feelsLike_c);
  
  }
  });
}
</script>

</head>
<body onload= "initialize()" bgcolor="#00BFFF">
<div id="content-pane">
     <div id="inputs">
       <p><button type="button" onclick="calculateDistances();">Calculate
         distance</button></p>
     </div>
     <div id="outputDiv"></div>
   </div>
<div id="map_canvas" style="width:700px; height:600px;">


</div>
<div>
GetWeatherForLocation
</div>
</body>
</html>
